\newcommand{\todo}[1]{\ensuremath{\textit{\textcolor{red}{TODO:}}\ \textrm{#1}}}

%% Definitions and theorems
\newtheorem{definition}{Definition}
\newtheorem{theorem}[definition]{Theorem}
\newtheorem{lemma}[definition]{Lemma}
\newtheorem{corollary}[definition]{Corollary}

\renewcommand\qedsymbol{$\blacksquare$}

%% Program keywords

\newcommand{\pgmcalls}{\ensuremath{\textbf{call}\ }}
\newcommand{\pgmif}{\ensuremath{\textbf{if}\ }}
\newcommand{\pgmthen}{\ensuremath{\textbf{then}\ }}
\newcommand{\pgmelse}{\ensuremath{\textbf{else}\ }}
\newcommand{\pgmlet}{\ensuremath{\textbf{let}\ }}
\newcommand{\pgmin}{\ensuremath{\textbf{in}\ }}
\newcommand{\pgmasserts}{\ensuremath{\textbf{assert}\ }}
\newcommand{\pgmrets}{\ensuremath{\textbf{ret}\ }}

\newcommand{\pgmmodule}[1]{\ensuremath{\textbf{Module}\ #1}}
\newcommand{\pgmregs}[1]{\ensuremath{\textbf{Regs}\ #1}}
\newcommand{\pgminsts}[1]{\ensuremath{\textbf{Instances}\ #1}}
\newcommand{\pgmrule}[1]{\ensuremath{\textbf{Rule}\ #1}}
\newcommand{\pgmmeth}[1]{\ensuremath{\textbf{Method}\ #1}}
\newcommand{\pgmameth}[1]{\ensuremath{\textbf{ActionMethod}\ #1}}

\newcommand{\pgmwrite}[2]{\ensuremath{#1 := #2\,;}\\}
\newcommand{\pgmcall}[3]{\ensuremath{#1 = \pgmcalls{} #2(#3)\,;}\\}
\newcommand{\pgmcalln}[2]{\ensuremath{\pgmcalls{} #1(#2)\,;}\\}
\newcommand{\pgmletin}[2]{\ensuremath{\pgmlet{} #1 = #2\ \pgmin{}}\\}
\newcommand{\pgmifelse}[4]{\ensuremath{\pgmif{} #1\ \pgmthen{} #2\ \pgmelse{} #3\,;}\\}
\newcommand{\pgmassert}[1]{\ensuremath{\pgmasserts{} #1\,;}\\}
\newcommand{\pgmret}[1]{\ensuremath{\pgmrets{} #1}\\}

%% BSV boxes by Murali

%% \newcommand{\bsvcodesize}{\footnotesize}
\newcommand{\bsvcodesize}{\small}

%BSV block
\newcommand{\bsvblock}[1]{
\ensuremath{
\begin{array}{@{\;\;\;\;\;\;}l}
#1
\end{array}}\\
}

%BSV normal rule
\newcommand{\bsv}[6]{
\begin{tabular}{@{}p{7cm}@{}}
\ensuremath{#1} {\it #2} #3:\\
\hline
\ensuremath{
\begin{array}{@{}l}
#4
\begin{array}{@{}l@{}l}
\when ( & 
#5) \pmb{\Rightarrow} \\
\end{array}\\
\bsvblock{#6}
\end{array}
}\\\\
\end{tabular}
}

%BSV rule without guard or let
\newcommand{\bsvnone}[4]{
\begin{tabular}{@{}p{7cm}@{}}
\ensuremath{#1} {\it #2} #3:\\
\hline
\ensuremath{
\begin{array}{@{}l@{}}
#4\\
\end{array}
}
\end{tabular}
}

%BSV rule without guard or let
\newcommand{\bsvnonesmall}[5]{
\begin{tabular}{@{}p{#5}@{}}
\ensuremath{#1} {\it #2} #3:\\
\hline
\ensuremath{
\begin{array}{@{}l@{}}
#4\\
\end{array}
}
\end{tabular}
}

%BSV module

\newcommand{\bsvmodinst}[3]{
\bsvcodesize
\centering
\begin{tabular}{|l|}
\hline\\
\pgmmodule{} #1:\\
\pgminsts \ensuremath{#2};\\[.5em]
\hline\\[-.5em]
#3\\
\hline
\end{tabular}
}

\newcommand{\bsvmod}[3]{
\bsvcodesize
\centering
\begin{tabular}{|l|}
\hline\\
\pgmmodule{} #1:\\
\pgmregs \ensuremath{#2};\\[.5em]
\hline\\[-.5em]
#3\\
\hline
\end{tabular}
}

\newcommand{\bsvmodnoreg}[2]{
\bsvcodesize
\centering
\begin{tabular}{|l|}
\hline\\
\pgmmodule{} #1:\\
\hline\\[-.5em]
#2\\
\hline
\end{tabular}
}

\newcommand{\bsvmodtbig}[3]{
\bsvcodesize
\centering
\begin{tabular}{|p{\textwidth}|}
\hline\\
\pgmmodule{}:\\
\pgmregs \ensuremath{#1};\\[.5em]
\hline\\[-.5em]
\begin{tabular}{cc}
\begin{minipage}{.5\textwidth}
#2
\end{minipage} &
\begin{minipage}{.5\textwidth}
#3
\end{minipage}
\end{tabular}\\
\hline
\end{tabular}
}

\newcommand{\bsvmodtsmall}[3]{
\bsvcodesize
\centering
\begin{tabular}{|p{\textwidth}|}
\hline\\[-.8em]
\pgmmodule{}:\\
\pgmregs \ensuremath{#1};\\[.2em]
\hline\\[-.5em]
\begin{tabular}{cc}
\begin{minipage}{.5\textwidth}
#2
\end{minipage} &
\begin{minipage}{.5\textwidth}
#3
\end{minipage}
\end{tabular}\\
\hline
\end{tabular}
}

%% Keywords
\newcommand{\ie}{\emph{i.e.,}}
\newcommand{\eg}{\emph{e.g.,}}

%% Proper names
\newcommand{\Bluespec}{Bluespec}
\newcommand{\Kami}{Kami}

%% For Latex convenience
\newcommand{\refchap}[1]{Chapter~\ref{#1}}
\newcommand{\refsect}[1]{Section~\ref{#1}}
\newcommand{\refdef}[1]{Definition~\ref{#1}}
\newcommand{\refthm}[1]{Theorem~\ref{#1}}
\newcommand{\reflem}[1]{Lemma~\ref{#1}}
\newcommand{\reffig}[1]{Figure~\ref{#1}}

%% Sets
\newcommand{\setconst}{\ensuremath{\mathcal{C}}}
\newcommand{\setregs}{\ensuremath{\mathcal{R}}}
\newcommand{\setrules}{\ensuremath{\mathcal{L}}}
\newcommand{\setmeths}{\ensuremath{\mathcal{F}}}

%% Syntax
\renewcommand{\listof}[1]{\ensuremath{\overrightarrow{#1}}}
\newcommand{\fail}{\ensuremath{\textsf{fail}}}

\newcommand{\wordlet}{\ensuremath{\textsf{let}\ }}
\newcommand{\wordassert}{\ensuremath{\textsf{assert}\ }}
\newcommand{\wordret}{\ensuremath{\textsf{return}\ }}
\newcommand{\wordin}{\ensuremath{\textsf{in}\ }}
\newcommand{\wordif}{\ensuremath{\textsf{if}\ }}
\newcommand{\wordthen}{\ensuremath{\textsf{then}\ }}
\newcommand{\wordelse}{\ensuremath{\textsf{else}\ }}
\newcommand{\wordforeach}{\ensuremath{\textsf{foreach}\ }}

\newcommand{\tab}{\ensuremath{\quad}}

\newcommand{\seop}{\ensuremath{\textsf{op}}}
\newcommand{\eop}[1]{\ensuremath{\seop{}(\listof{#1})}}

\newcommand{\actwrite}[3]{\ensuremath{#1 := #2\,;\ #3}}
%% \newcommand{\actcall}[4]{\ensuremath{\wordlet{} #1 = #2(#3)\,;\ #4}}
\newcommand{\actcall}[4]{\ensuremath{#2(#3)\,;\ \lambda #1.#4}}
\newcommand{\actlet}[3]{\ensuremath{\wordlet{} #1\ \wordin{} \lambda #2.#3}}
\newcommand{\actifelse}[5]{\ensuremath{\wordif{} #1\ \wordthen{} #2\ \wordelse{} #3\,;\ \lambda #4.#5}}
\newcommand{\actassert}[2]{\ensuremath{\wordassert{} #1\,;\ #2}}
\newcommand{\actret}[1]{\ensuremath{\wordret{} #1}}

\newcommand{\regpair}[2]{\ensuremath{(#1, #2)}}
\newcommand{\rulepair}[2]{\ensuremath{(#1, #2)}}
\newcommand{\methodpair}[2]{\ensuremath{(#1, #2)}}
\newcommand{\modbasic}[3]{\ensuremath{(\listof{#1}, \listof{#2}, \listof{#3})}}
\newcommand{\modcomp}[2]{\ensuremath{#1 \oplus #2}}

%% Semantics

\newcommand{\btrue}{\ensuremath{\textsf{true}}}
\newcommand{\bfalse}{\ensuremath{\textsf{false}}}
\newcommand{\band}{\ensuremath{\&\&}}

\renewcommand{\emptyset}{\ensuremath{\varnothing}}
\newcommand{\emptymap}{\ensuremath{[]}}
\newcommand{\finmapsymb}{\ensuremath{\stackrel{\textrm{\footnotesize{fin}}}{\longrightarrow}}}
\newcommand{\sttype}{\ensuremath{\setregs \finmapsymb \setconst}}
\newcommand{\lbtype}{\ensuremath{\setmeths \finmapsymb \setconst \times \setconst}}
\newcommand{\stupd}[3]{\ensuremath{#1 [ #2 \leftarrow #3 ]}}
\newcommand{\lblupd}[3]{\ensuremath{#1 [ #2 \leftarrow #3 ]}}
\newcommand{\setadd}[2]{\ensuremath{#1 \cup \{ #2 \}}}

\newcommand{\listnil}{\ensuremath{[]}}
\newcommand{\listcons}[2]{\ensuremath{#1::#2}}

\newcommand{\denot}[1]{\ensuremath{\llbracket #1 \rrbracket}}
\newcommand{\ssemexpr}[1]{\ensuremath{\denot{#1}_{\textsf{e}}}}
\newcommand{\semexpr}[2]{\ensuremath{\ssemexpr{#1}\ #2}}

\newcommand{\semact}[5]{\ensuremath{#1 |- (#2) \Downarrow \langle #3, #4, #5 \rangle}}
\newcommand{\semlbl}[3]{\ensuremath{\langle #1, #2, #3 \rangle}}
\newcommand{\semsstepr}[4]{\ensuremath{\langle #1, #2 \rangle \Downarrow \langle #3, #4 \rangle}}
\newcommand{\semsstep}[6]{\ensuremath{\langle #1, #2 \rangle \Downarrow \langle #3, \semlbl{#4}{#5}{#6} \rangle}}
\newcommand{\semsss}[4]{\ensuremath{\langle #1, #2 \rangle \Downarrow^{\ast} \langle #3, #4 \rangle}}
\newcommand{\semstep}[4]{\ensuremath{#2 \stackrel[#1]{#4}{\longrightarrow} #3}}

\newcommand{\Substep}{Substep}
\newcommand{\Substeps}{Substeps}
\newcommand{\Step}{Step}

\newcommand{\alpharule}[1]{\ensuremath{\textsf{Rule}\ #1}}
\newcommand{\alphameth}{\ensuremath{\textsf{Meth}}}

\newcommand{\namesof}[1]{\ensuremath{\textsf{namesOf}\ #1}}
\newcommand{\regsofm}[1]{\ensuremath{\textsf{regsOf}\ #1}}
\newcommand{\rulesofm}[1]{\ensuremath{\textsf{rulesOf}\ #1}}
\newcommand{\methsofm}[1]{\ensuremath{\textsf{methodsOf}\ #1}}
\newcommand{\callsofm}[1]{\ensuremath{\textsf{callsOf}\ #1}}
\newcommand{\callsofa}[1]{\ensuremath{\textsf{callsOfA}\ #1}}

\newcommand{\sdisj}[2]{\ensuremath{#1 \ast #2}}
\newcommand{\splus}[2]{\ensuremath{#1 \uplus #2}}
\newcommand{\sunion}[2]{\ensuremath{#1 \cup #2}}
\newcommand{\domof}[1]{\ensuremath{\textsf{domain}\ #1}}

\newcommand{\ldisj}[2]{\ensuremath{#1 \ast #2}}
\newcommand{\lplus}[2]{\ensuremath{#1 \uplus #2}}
\newcommand{\lunion}[2]{\ensuremath{#1 \cup #2}}

\newcommand{\annotof}[1]{\ensuremath{\textsf{annot}\ #1}}
\newcommand{\defsof}[1]{\ensuremath{\textsf{defs}\ #1}}
\newcommand{\callsof}[1]{\ensuremath{\textsf{calls}\ #1}}

\newcommand{\anndisj}[2]{\ensuremath{#1 \ast #2}}
\newcommand{\mdisj}[2]{\ensuremath{#1 \ast #2}}
\newcommand{\setdisj}[2]{\ensuremath{#1 \ast #2}}
\newcommand{\keysdisj}[2]{\ensuremath{\setdisj{\domof{#1}}{#2}}}

\newcommand{\annplus}[2]{\ensuremath{#1 \uplus #2}}
\newcommand{\mplus}[2]{\ensuremath{#1 \uplus #2}}

\newcommand{\wellhidden}[2]{\ensuremath{\textsf{wellHidden}\ #1\ #2}}
\newcommand{\hidesym}{\ensuremath{\textsf{hide}}}
\newcommand{\hide}[1]{\ensuremath{\hidesym{}\ #1}}
\newcommand{\hidemethsym}{\ensuremath{\textsf{hideMeth}}}
\newcommand{\hidemeth}[2]{\ensuremath{\hidemethsym{}\ #1\ #2}}
\newcommand{\hidemethssym}{\ensuremath{\textsf{hideMeths}}}
\newcommand{\hidemeths}[2]{\ensuremath{\hidemethssym{}\ #1\ #2}}

%% well-formedness

\newcommand{\wfdouble}[1]{\ensuremath{\textsf{WfDouble}\ #1}}
\newcommand{\wfdoubleap}[3]{\ensuremath{\textsf{WfDoubleA'}\ #1\ #2\ #3}}
\newcommand{\wfdoublea}[1]{\ensuremath{\textsf{WfDoubleA}\ #1}}

\newcommand{\wfcycle}[1]{\ensuremath{\textsf{WfCycle}\ #1}}

%% inlining

\newcommand{\concatsymb}{\ensuremath{::}}
\newcommand{\concataction}[2]{\ensuremath{#1 \concatsymb{} \lambda x.#2}}
\newcommand{\inlinedmsymb}{\ensuremath{\hookleftarrow}}
\newcommand{\inlinedm}[2]{\ensuremath{#1 \inlinedmsymb{} #2}}
\newcommand{\inlinedmssymb}{\ensuremath{\hookleftarrow^{\ast}}}
\newcommand{\inlinedms}[2]{\ensuremath{#1 \inlinedmssymb{} #2}}
\newcommand{\inlinedmmsymb}{\ensuremath{\hookleftarrow_{m}}}
\newcommand{\inlinedmm}[2]{\ensuremath{#1 \inlinedmmsymb{} #2}}
\newcommand{\inline}[1]{\ensuremath{| #1 |}}
\newcommand{\inlineF}[1]{\ensuremath{\| #1 \|}}

\newcommand{\isrec}[1]{\ensuremath{\textsf{isRecursive}\ #1}}

\newcommand{\mapfiltsymb}{\ensuremath{\smallsetminus}}
\newcommand{\mapfilt}[2]{\ensuremath{#1 \mapfiltsymb{} #2}}

\newcommand{\StepInl}{StepInl}
\newcommand{\semstepin}[4]{\ensuremath{#2 \stackrel[#1]{#4}{\hookrightarrow} #3}}

%% big-step semantics

\newcommand{\sembigact}[6]{\ensuremath{#1, #2 |- (#3) \leadsto \langle #4, #5, #6 \rangle}}
\newcommand{\sembigssr}[4]{\ensuremath{\langle #1, #2 \rangle \leadsto \langle #3, #4 \rangle}}
\newcommand{\sembigss}[6]{\ensuremath{\langle #1, #2 \rangle \leadsto \langle #3, \semlbl{#4}{#5}{#6} \rangle}}
\newcommand{\sembigstep}[4]{\ensuremath{#2 \stackrel[#1]{#4}{\leadsto} #3}}

\newcommand{\Bigsubstep}{BigSubstep}
\newcommand{\Bigstep}{BigStep}

